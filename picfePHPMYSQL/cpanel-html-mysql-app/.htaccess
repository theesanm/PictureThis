# PictureThis .htaccess - Production Configuration
# Environment variables are now handled by .env file
# This file contains only Apache/PHP configuration

# ==========================================
# PHP UPLOAD CONFIGURATION
# ==========================================
# Increase PHP upload limits for image uploads
php_value upload_max_filesize 20M
php_value post_max_size 25M
php_value memory_limit 128M
php_value max_execution_time 300
php_value max_input_time 300

# Prevent PHP parsing of static files
<FilesMatch "\.(css|js|png|jpg|jpeg|gif|ico|svg|woff|woff2|ttf|eot)$">
    SetHandler default-handler
    RemoveHandler .css .js .png .jpg .jpeg .gif .ico .svg .woff .woff2 .ttf .eot
</FilesMatch>

# Enable rewrite engine
RewriteEngine On

# Allow direct access to specific test and utility files
RewriteRule ^test_.*\.php$ - [L]
RewriteRule ^web_install\.php$ - [L]

# Allow direct access to all files and directories first
RewriteCond %{REQUEST_FILENAME} -f [OR]
RewriteCond %{REQUEST_FILENAME} -d
RewriteRule ^ - [L]

# Route everything else to index.php
RewriteRule ^(.*)$ index.php [QSA,L]

# Security - protect config files
<Files "config.php">
    Order Allow,Deny
    Deny from all
</Files>

# MIME types for static files
AddType text/css .css
AddType application/javascript .js
AddType image/png .png
AddType image/jpeg .jpg
AddType image/jpeg .jpeg
AddType image/gif .gif
AddType image/x-icon .ico
AddType image/svg+xml .svg
AddType font/woff .woff
AddType font/woff2 .woff2
AddType font/ttf .ttf
AddType application/vnd.ms-fontobject .eot