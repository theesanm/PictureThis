<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Picture This - Infrastructure Setup</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            border-radius: 10px;
            margin-bottom: 30px;
            text-align: center;
        }
        .section {
            background: white;
            margin-bottom: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        .section-header {
            background: #4CAF50;
            color: white;
            padding: 15px 20px;
            margin: 0;
            font-size: 1.2em;
        }
        .section-content {
            padding: 20px;
        }
        .status {
            display: inline-block;
            padding: 3px 8px;
            border-radius: 12px;
            font-size: 0.8em;
            font-weight: bold;
            background: #28a745;
            color: white;
        }
        .status.pending { background: #ffc107; color: black; }
        .status.completed { background: #28a745; color: white; }
        .infrastructure-diagram {
            background: #f8f9fa;
            border: 2px solid #dee2e6;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
            text-align: center;
        }
        .code-block {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 4px;
            padding: 15px;
            margin: 10px 0;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
            overflow-x: auto;
        }
        .file-structure {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 8px;
            padding: 15px;
            margin: 10px 0;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
        }
        .config-item {
            background: #e8f5e8;
            border: 1px solid #d4edda;
            border-radius: 8px;
            padding: 15px;
            margin: 10px 0;
        }
        .config-item h4 {
            margin-top: 0;
            color: #155724;
        }
        .summary {
            background: #fff;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }
        th, td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }
        th {
            background-color: #f8f9fa;
            font-weight: bold;
        }
        .checklist {
            list-style-type: none;
            padding: 0;
        }
        .checklist li {
            padding: 8px 0;
            border-bottom: 1px solid #eee;
        }
        .checklist li:before {
            content: "✅";
            color: #28a745;
            font-weight: bold;
            margin-right: 10px;
        }
        .pending li:before {
            content: "⏳";
            color: #ffc107;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>🏗️ Picture This - Infrastructure Setup</h1>
        <p>Complete Development Environment & Deployment Infrastructure</p>
        <p><strong>Document Version:</strong> 1.0 | <strong>Date:</strong> September 5, 2025</p>
    </div>

    <div class="summary">
        <h2>📊 Executive Summary</h2>
        <p>This document outlines the comprehensive infrastructure setup for Picture This, covering development environment configuration, version control, database setup, and deployment pipeline. The infrastructure is designed to support scalable development and production deployment of the AI image generation platform.</p>
    </div>

    <div class="section">
        <h2 class="section-header">🖥️ 1. Development Environment Configuration</h2>
        <div class="section-content">
            <div class="infrastructure-diagram">
                <h3>Development Environment Architecture</h3>
                <pre>
┌─────────────────────────────────────┐
│         Development Machine         │
├─────────────────────────────────────┤
│ • macOS 14.0                        │
│ • Node.js 18+                       │
│ • PostgreSQL 15                     │
│ • Git 2.39+                         │
│ • VS Code                           │
└─────────────────────────────────────┘
                │
                ▼
┌─────────────────────────────────────┐
│         Project Structure           │
├─────────────────────────────────────┤
│ backend/                            │
│ ├── src/                            │
│ │   ├── routes/                     │
│ │   ├── controllers/                │
│ │   ├── middleware/                 │
│ │   ├── utils/                      │
│ │   └── server.js                   │
│ ├── package.json                    │
│ └── .env                            │
│                                     │
│ frontend/                           │
│ ├── src/                            │
│ │   ├── components/                 │
│ │   ├── pages/                      │
│ │   └── utils/                      │
│ ├── package.json                    │
│ └── vite.config.js                  │
└─────────────────────────────────────┘
            </pre>
            </div>

            <h3>System Requirements</h3>
            <table>
                <thead>
                    <tr>
                        <th>Component</th>
                        <th>Version</th>
                        <th>Status</th>
                        <th>Purpose</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Operating System</td>
                        <td>macOS 14.0+</td>
                        <td><span class="status completed">Completed</span></td>
                        <td>Development environment</td>
                    </tr>
                    <tr>
                        <td>Node.js</td>
                        <td>18.0+</td>
                        <td><span class="status completed">Completed</span></td>
                        <td>Runtime for backend and frontend</td>
                    </tr>
                    <tr>
                        <td>PostgreSQL</td>
                        <td>15.0+</td>
                        <td><span class="status completed">Completed</span></td>
                        <td>Primary database</td>
                    </tr>
                    <tr>
                        <td>Git</td>
                        <td>2.39+</td>
                        <td><span class="status completed">Completed</span></td>
                        <td>Version control</td>
                    </tr>
                    <tr>
                        <td>VS Code</td>
                        <td>Latest</td>
                        <td><span class="status completed">Completed</span></td>
                        <td>IDE for development</td>
                    </tr>
                </tbody>
            </table>

            <h3>Backend Configuration</h3>
            <div class="config-item">
                <h4>Package Dependencies</h4>
                <div class="code-block">
{
  "name": "picturethis-backend",
  "version": "1.0.0",
  "dependencies": {
    "express": "^4.18.2",
    "pg": "^8.11.3",
    "bcryptjs": "^2.4.3",
    "jsonwebtoken": "^9.0.2",
    "cors": "^2.8.5",
    "dotenv": "^16.3.1",
    "multer": "^1.4.5-lts.1",
    "stripe": "^13.11.0",
    "helmet": "^7.1.0",
    "express-rate-limit": "^7.1.5",
    "express-validator": "^7.0.1",
    "joi": "^17.11.0"
  }
}
                </div>
            </div>

            <div class="config-item">
                <h4>Environment Variables (.env)</h4>
                <div class="code-block">
# Database Configuration
DB_HOST=localhost
DB_PORT=5430
DB_NAME=PictureThis
DB_USER=postgres
DB_PASSWORD=200Sti007@

# Server Configuration
PORT=3011
NODE_ENV=development

# JWT Configuration
JWT_SECRET=your-super-secret-jwt-key-change-this-in-production
JWT_EXPIRE=7d

# File Upload Configuration
UPLOAD_PATH=./uploads
MAX_FILE_SIZE=10485760
                </div>
            </div>

            <h3>Frontend Configuration</h3>
            <div class="config-item">
                <h4>Vite Configuration</h4>
                <div class="code-block">
import { defineConfig } from 'vite'
import react from '@vitejs/plugin-react'

export default defineConfig({
  plugins: [react()],
  server: {
    port: 3010,
    proxy: {
      '/api': {
        target: 'http://localhost:3011',
        changeOrigin: true
      }
    }
  },
  build: {
    outDir: 'dist',
    sourcemap: true
  }
})
                </div>
            </div>

            <h3>Development Scripts</h3>
            <div class="code-block">
# Backend scripts
npm start      # Production server
npm run dev    # Development server with nodemon
npm test       # Run tests
npm run migrate # Database migration

# Frontend scripts
npm run dev    # Development server
npm run build  # Production build
npm run preview # Preview production build
            </div>
        </div>
    </div>

    <div class="section">
        <h2 class="section-header">📚 2. Version Control Repository Setup</h2>
        <div class="section-content">
            <h3>Git Repository Configuration</h3>
            <table>
                <thead>
                    <tr>
                        <th>Property</th>
                        <th>Value</th>
                        <th>Status</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Repository Name</td>
                        <td>PictureThis</td>
                        <td><span class="status completed">Completed</span></td>
                    </tr>
                    <tr>
                        <td>Owner</td>
                        <td>theesanm</td>
                        <td><span class="status completed">Completed</span></td>
                    </tr>
                    <tr>
                        <td>Branch</td>
                        <td>main</td>
                        <td><span class="status completed">Completed</span></td>
                    </tr>
                    <tr>
                        <td>Remote URL</td>
                        <td>git@github.com:theesanm/PictureThis.git</td>
                        <td><span class="status completed">Completed</span></td>
                    </tr>
                </tbody>
            </table>

            <h3>Git Configuration</h3>
            <div class="code-block">
# Local Git Configuration
git config --global user.name "Theesan Moodley"
git config --global user.email "theesan@example.com"

# Repository Status
$ git status
On branch main
Your branch is up to date with 'origin/main'.

Untracked files:
  (use "git add <file>..." to include in what will be committed)
        .gitignore
        README.md
        backend/
        development-plan.html
        frontend/
        requirements-gathering.html
        technical-architecture.html

nothing added to commit but untracked files present (use "git add" to track)
            </div>

            <h3>.gitignore Configuration</h3>
            <div class="code-block">
# Dependencies
node_modules/
npm-debug.log*
yarn-debug.log*
yarn-error.log*

# Environment variables
.env
.env.local
.env.development.local
.env.test.local
.env.production.local

# Build outputs
dist/
build/

# IDE files
.vscode/
.idea/
*.swp
*.swo

# OS files
.DS_Store
Thumbs.db

# Logs
logs/
*.log

# Uploads
uploads/

# Database
*.db
*.sqlite

# Coverage
coverage/
.nyc_output/

# Temporary files
tmp/
temp/
            </div>

            <h3>Branching Strategy</h3>
            <ul class="checklist">
                <li><strong>Main Branch:</strong> Production-ready code</li>
                <li><strong>Development Branch:</strong> Integration branch for features</li>
                <li><strong>Feature Branches:</strong> Individual feature development</li>
                <li><strong>Release Branches:</strong> Preparation for production releases</li>
                <li><strong>Hotfix Branches:</strong> Critical bug fixes</li>
            </ul>

            <h3>Commit Message Convention</h3>
            <div class="code-block">
# Format: type(scope): description

# Types:
feat:     A new feature
fix:      A bug fix
docs:     Documentation only changes
style:    Changes that do not affect the meaning of the code
refactor: A code change that neither fixes a bug nor adds a feature
test:     Adding missing tests or correcting existing tests
chore:    Changes to the build process or auxiliary tools

# Examples:
feat(auth): add JWT authentication
fix(api): resolve database connection issue
docs(readme): update installation instructions
            </div>
        </div>
    </div>

    <div class="section">
        <h2 class="section-header">🗄️ 3. Database Server Configuration</h2>
        <div class="section-content">
            <h3>PostgreSQL Setup</h3>
            <table>
                <thead>
                    <tr>
                        <th>Configuration</th>
                        <th>Value</th>
                        <th>Status</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Host</td>
                        <td>localhost</td>
                        <td><span class="status completed">Completed</span></td>
                    </tr>
                    <tr>
                        <td>Port</td>
                        <td>5430</td>
                        <td><span class="status completed">Completed</span></td>
                    </tr>
                    <tr>
                        <td>Database</td>
                        <td>PictureThis</td>
                        <td><span class="status completed">Completed</span></td>
                    </tr>
                    <tr>
                        <td>Username</td>
                        <td>postgres</td>
                        <td><span class="status completed">Completed</span></td>
                    </tr>
                    <tr>
                        <td>Connection Pool</td>
                        <td>20 connections</td>
                        <td><span class="status completed">Completed</span></td>
                    </tr>
                </tbody>
            </table>

            <h3>Database Connection</h3>
            <div class="config-item">
                <h4>Connection Configuration</h4>
                <div class="code-block">
const { Pool } = require('pg');

const pool = new Pool({
  host: process.env.DB_HOST,
  port: process.env.DB_PORT,
  database: process.env.DB_NAME,
  user: process.env.DB_USER,
  password: process.env.DB_PASSWORD,
  max: 20,
  idleTimeoutMillis: 30000,
  connectionTimeoutMillis: 2000,
});

// Test connection
pool.on('connect', () => {
  console.log('📊 Connected to PostgreSQL database');
});
                </div>
            </div>

            <h3>Database Schema</h3>
            <div class="file-structure">
PictureThis Database Schema:
├── users (5 columns)
│   ├── id (SERIAL, PK)
│   ├── email (VARCHAR, UNIQUE)
│   ├── password_hash (VARCHAR)
│   ├── full_name (VARCHAR)
│   ├── credits (INTEGER, DEFAULT 0)
│   ├── is_admin (BOOLEAN, DEFAULT FALSE)
│   ├── created_at (TIMESTAMP)
│   └── updated_at (TIMESTAMP)
├── credit_transactions (7 columns)
│   ├── id (SERIAL, PK)
│   ├── user_id (INTEGER, FK → users.id)
│   ├── amount (INTEGER)
│   ├── transaction_type (VARCHAR)
│   ├── stripe_payment_id (VARCHAR)
│   ├── description (TEXT)
│   └── created_at (TIMESTAMP)
├── images (9 columns)
│   ├── id (SERIAL, PK)
│   ├── user_id (INTEGER, FK → users.id)
│   ├── prompt (TEXT)
│   ├── image_url (VARCHAR)
│   ├── image_data (BYTEA)
│   ├── file_name (VARCHAR)
│   ├── file_size (INTEGER)
│   ├── generation_cost (INTEGER)
│   └── created_at (TIMESTAMP)
├── api_usage_logs (7 columns)
│   ├── id (SERIAL, PK)
│   ├── user_id (INTEGER, FK → users.id)
│   ├── endpoint (VARCHAR)
│   ├── method (VARCHAR)
│   ├── status_code (INTEGER)
│   ├── response_time (INTEGER)
│   └── created_at (TIMESTAMP)
└── settings (4 columns)
    ├── id (SERIAL, PK)
    ├── key (VARCHAR, UNIQUE)
    ├── value (TEXT)
    └── updated_at (TIMESTAMP)
            </div>

            <h3>Database Migration Status</h3>
            <ul class="checklist">
                <li>✅ Database connection established</li>
                <li>✅ All tables created successfully</li>
                <li>✅ Foreign key relationships configured</li>
                <li>✅ Default settings inserted</li>
                <li>✅ Migration scripts functional</li>
            </ul>

            <h3>Database Performance Configuration</h3>
            <div class="code-block">
# PostgreSQL Configuration (postgresql.conf)
shared_buffers = 256MB
effective_cache_size = 1GB
work_mem = 4MB
maintenance_work_mem = 64MB
checkpoint_completion_target = 0.9
wal_buffers = 16MB
default_statistics_target = 100

# Connection Settings
max_connections = 100
tcp_keepalives_idle = 60
tcp_keepalives_interval = 10
            </div>
        </div>
    </div>

    <div class="section">
        <h2 class="section-header">🚀 4. Build & Deployment Pipeline</h2>
        <div class="section-content">
            <h3>Current Build Setup</h3>
            <table>
                <thead>
                    <tr>
                        <th>Component</th>
                        <th>Build Tool</th>
                        <th>Status</th>
                        <th>Output</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Backend</td>
                        <td>npm scripts</td>
                        <td><span class="status completed">Completed</span></td>
                        <td>Node.js application</td>
                    </tr>
                    <tr>
                        <td>Frontend</td>
                        <td>Vite</td>
                        <td><span class="status completed">Completed</span></td>
                        <td>Static files (dist/)</td>
                    </tr>
                    <tr>
                        <td>Database</td>
                        <td>Custom migration scripts</td>
                        <td><span class="status completed">Completed</span></td>
                        <td>Schema updates</td>
                    </tr>
                </tbody>
            </table>

            <h3>Development Workflow</h3>
            <div class="code-block">
# Development Server Setup
# Terminal 1: Backend
cd backend
npm run dev

# Terminal 2: Frontend
cd frontend
npm run dev

# Database Migration
cd backend/src/utils
node migrate.js

# Production Build
cd frontend
npm run build
            </div>

            <h3>Docker Configuration (Planned)</h3>
            <div class="config-item">
                <h4>Dockerfile (Backend)</h4>
                <div class="code-block">
FROM node:18-alpine
WORKDIR /app
COPY package*.json ./
RUN npm ci --only=production
COPY . .
EXPOSE 3001
CMD ["npm", "start"]
                </div>
            </div>

            <div class="config-item">
                <h4>docker-compose.yml</h4>
                <div class="code-block">
version: '3.8'
services:
  app:
    build: .
    ports:
      - "3001:3001"
    environment:
      - NODE_ENV=production
    depends_on:
      - postgres

  postgres:
    image: postgres:15
    environment:
      - POSTGRES_DB=picturethis
      - POSTGRES_USER=postgres
      - POSTGRES_PASSWORD=secure_password
    volumes:
      - postgres_data:/var/lib/postgresql/data

volumes:
  postgres_data:
                </div>
            </div>

            <h3>CI/CD Pipeline (Planned)</h3>
            <div class="config-item">
                <h4>GitHub Actions Workflow</h4>
                <div class="code-block">
name: CI/CD Pipeline

on:
  push:
    branches: [ main, develop ]
  pull_request:
    branches: [ main ]

jobs:
  test:
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v3
    - name: Setup Node.js
      uses: actions/setup-node@v3
      with:
        node-version: '18'
    - name: Install dependencies
      run: npm install
    - name: Run tests
      run: npm test
    - name: Build application
      run: npm run build

  deploy:
    needs: test
    runs-on: ubuntu-latest
    if: github.ref == 'refs/heads/main'
    steps:
    - name: Deploy to production
      run: echo "Deploy to production server"
                </div>
            </div>

            <h3>Deployment Environments</h3>
            <table>
                <thead>
                    <tr>
                        <th>Environment</th>
                        <th>URL</th>
                        <th>Database</th>
                        <th>Status</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Development</td>
                        <td>localhost:3010</td>
                        <td>Local PostgreSQL</td>
                        <td><span class="status completed">Completed</span></td>
                    </tr>
                    <tr>
                        <td>Staging</td>
                        <td>staging.picturethis.com</td>
                        <td>Staging PostgreSQL</td>
                        <td><span class="status pending">Planned</span></td>
                    </tr>
                    <tr>
                        <td>Production</td>
                        <td>app.picturethis.com</td>
                        <td>Production PostgreSQL</td>
                        <td><span class="status pending">Planned</span></td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>

    <div class="section">
        <h2 class="section-header">📊 5. Monitoring & Logging</h2>
        <div class="section-content">
            <h3>Application Logging</h3>
            <div class="code-block">
// Backend logging configuration
const morgan = require('morgan');
app.use(morgan('combined')); // HTTP request logging

// Custom logging for API usage
const logApiUsage = (req, res, next) => {
  const start = Date.now();
  res.on('finish', () => {
    const duration = Date.now() - start;
    console.log(`${req.method} ${req.originalUrl} ${res.statusCode} ${duration}ms`);
  });
  next();
};
            </div>

            <h3>Database Monitoring</h3>
            <ul class="checklist">
                <li>✅ Connection pool monitoring</li>
                <li>✅ Query performance logging</li>
                <li>✅ Error tracking and reporting</li>
                <li>⏳ Query optimization analysis</li>
                <li>⏳ Database backup automation</li>
            </ul>

            <h3>Health Checks</h3>
            <div class="code-block">
// Health check endpoint
app.get('/api/health', (req, res) => {
  res.json({
    status: 'OK',
    timestamp: new Date().toISOString(),
    uptime: process.uptime(),
    database: 'Connected'
  });
});

// Database health check
app.get('/api/health/db', async (req, res) => {
  try {
    await query('SELECT 1');
    res.json({ status: 'OK', database: 'Connected' });
  } catch (error) {
    res.status(500).json({ status: 'ERROR', database: 'Disconnected' });
  }
});
            </div>
        </div>
    </div>

    <div class="section">
        <h2 class="section-header">🔧 6. Development Tools & Extensions</h2>
        <div class="section-content">
            <h3>VS Code Extensions</h3>
            <ul class="checklist">
                <li><strong>ESLint:</strong> JavaScript code linting</li>
                <li><strong>Prettier:</strong> Code formatting</li>
                <li><strong>GitLens:</strong> Enhanced Git capabilities</li>
                <li><strong>Auto Rename Tag:</strong> HTML tag synchronization</li>
                <li><strong>Bracket Pair Colorizer:</strong> Bracket matching</li>
                <li><strong>PostgreSQL:</strong> Database management</li>
            </ul>

            <h3>Development Scripts</h3>
            <div class="code-block">
# package.json scripts (backend)
{
  "scripts": {
    "start": "node src/server.js",
    "dev": "nodemon src/server.js",
    "test": "jest",
    "migrate": "node src/utils/migrate.js",
    "seed": "node src/utils/seed.js"
  }
}

# package.json scripts (frontend)
{
  "scripts": {
    "dev": "vite",
    "build": "vite build",
    "preview": "vite preview",
    "lint": "eslint src --ext .js,.jsx,.ts,.tsx",
    "format": "prettier --write src/**/*.{js,jsx,ts,tsx,css,md}"
  }
}
            </div>

            <h3>Code Quality Tools</h3>
            <ul class="checklist">
                <li><strong>ESLint:</strong> Code linting and style enforcement</li>
                <li><strong>Prettier:</strong> Automatic code formatting</li>
                <li><strong>Husky:</strong> Git hooks for pre-commit checks</li>
                <li><strong>lint-staged:</strong> Run linters on staged files</li>
                <li><strong>Commitlint:</strong> Conventional commit message validation</li>
            </ul>
        </div>
    </div>

    <div class="summary">
        <h2>📝 Infrastructure Setup Summary</h2>

        <h3>✅ Completed Components</h3>
        <ul class="checklist">
            <li><strong>Development Environment:</strong> Node.js, PostgreSQL, VS Code configured</li>
            <li><strong>Version Control:</strong> Git repository initialized with proper .gitignore</li>
            <li><strong>Database Server:</strong> PostgreSQL configured with complete schema</li>
            <li><strong>Project Structure:</strong> Backend and frontend folders with proper organization</li>
            <li><strong>Build System:</strong> npm scripts and Vite configuration</li>
            <li><strong>Environment Configuration:</strong> .env files with secure credential management</li>
        </ul>

        <h3>⏳ Planned Enhancements</h3>
        <ul class="pending">
            <li><strong>Docker Integration:</strong> Containerization for consistent deployments</li>
            <li><strong>CI/CD Pipeline:</strong> Automated testing and deployment</li>
            <li><strong>Monitoring Tools:</strong> Application performance monitoring</li>
            <li><strong>Backup Strategy:</strong> Automated database backups</li>
            <li><strong>Load Balancing:</strong> Multiple server instances</li>
        </ul>

        <h3>🚀 Current Status</h3>
        <p>The infrastructure is fully configured for development and ready for core feature implementation. The backend server is operational, database is connected, and the frontend development environment is prepared.</p>

        <p><strong>Next Steps:</strong></p>
        <ul>
            <li>Begin core development (authentication system)</li>
            <li>Implement user registration and login</li>
            <li>Set up credit management system</li>
            <li>Integrate AI image generation APIs</li>
        </ul>

        <p><strong>Document Status:</strong> <span class="status">Completed</span></p>
        <p><strong>Last Updated:</strong> September 5, 2025</p>
    </div>
</body>
</html>
